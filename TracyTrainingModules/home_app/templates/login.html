{% extends "home.html" %}
{% block module %}

<div class="card shadow mb-4">
  <div class="card-header py-3">
    <h6 class="m-0 font-weight-bold text-primary" style="font-size:120%">Login / Register</h6>
  </div>
  <div class="card-body">
    <form method="post">
      <label for="access_code">Enter Access Code: </label>
      <input id="access_code" type="text" name="access_code" required>
      <br>
      <input onclick='get_access_code()' class='btn btn-primary' type="button" value="Submit">
    </form>
    <div class="submit-row" >
      <p align="right">
        <a href="/register/">Click here to register if you don't have an access code.</a>
      </p>
    </div>
  </div>
  <script>
    function get_access_code(){
      var access_code = $('#access_code').val();
      var all_access_codes = {{ all_access_codes|safe }};
      if (all_access_codes.includes(access_code)){
        $.ajax({
          type: "POST",
          url: {% url 'home' %},
          data: {'access_code':access_code, 'csrfmiddlewaretoken':'{{ csrf_token }}'},
          success: function(result){
            window.location = '/home/';
          }
        });
      }else{
        alert('Invalid Access Code!');
        $('#access_code').val('');
        return;
      }
    }
  </script>
</div>


{% endblock %}
